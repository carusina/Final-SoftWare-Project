<!DOCTYPE html>
<html lang="en"> 
<head>
    <title>고객 문의</title>
    
    <!-- Meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <meta name="description" content="Portal - Bootstrap 5 Admin Dashboard Template For Developers">
    <meta name="author" content="Xiaoying Riley at 3rd Wave Media">    
    <link rel="shortcut icon" href="favicon.ico"> 
    
    <!-- FontAwesome JS-->
    <script defer src="plugins/fontawesome/js/all.min.js"></script>
    
    <!-- App CSS -->  
    <link id="theme-style" rel="stylesheet" href="css/portal.css">

</head> 

<body class="app">   	
    <header class="app-header fixed-top">	   	            
        <div class="app-header-inner">  
	        <div class="container-fluid py-2">
		        <div class="app-header-content"> 
		            <div class="row justify-content-between align-items-center">
			        
				    <div class="col-auto">
					    <a id="sidepanel-toggler" class="sidepanel-toggler d-inline-block d-xl-none" href="#">
						    <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg>
					    </a>
				    </div><!--//col-->
		            <div class="search-mobile-trigger d-sm-none col">
			            <i class="search-mobile-trigger-icon fas fa-search"></i>
			        </div><!--//col-->		            
					<div class="app-utilities col-auto">
			            <div class="app-utility-item app-notifications-dropdown dropdown">    
				            <a class="dropdown-toggle no-toggle-arrow" id="notifications-dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false" title="Notifications">
					            <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
					            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bell icon" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
  <path d="M8 16a2 2 0 0 0 2-2H6a2 2 0 0 0 2 2z"/>
  <path fill-rule="evenodd" d="M8 1.918l-.797.161A4.002 4.002 0 0 0 4 6c0 .628-.134 2.197-.459 3.742-.16.767-.376 1.566-.663 2.258h10.244c-.287-.692-.502-1.49-.663-2.258C12.134 8.197 12 6.628 12 6a4.002 4.002 0 0 0-3.203-3.92L8 1.917zM14.22 12c.223.447.481.801.78 1H1c.299-.199.557-.553.78-1C2.68 10.2 3 6.88 3 6c0-2.42 1.72-4.44 4.005-4.901a1 1 0 1 1 1.99 0A5.002 5.002 0 0 1 13 6c0 .88.32 4.2 1.22 6z"/>
</svg>
					            <span class="icon-badge">0</span>
					        </a><!--//dropdown-toggle-->
					        
					        <div class="dropdown-menu p-0" aria-labelledby="notifications-dropdown-toggle">
					            <div class="dropdown-menu-header p-3">
						            <h5 class="dropdown-menu-title mb-0">Notifications</h5>
						        </div><!--//dropdown-menu-title-->
						        <div class="dropdown-menu-content">
							    <!--   <div class="item p-3">
								        <div class="row gx-2 justify-content-between align-items-center">
									        <div class="col-auto">
										       <img class="profile-image" src="images/jonjal.png.jpg" alt="">
									        </div>
									        <div class="col">
										        <div class="info"> 
											        <div class="desc">SeongHwan shared a file with you. </div>
											        <div class="meta"> 2 hrs ago</div>
										        </div>
									        </div> 
								        </div>
								        <a class="link-mask" href="/notifications"></a>
							       </div>
								   
							       <div class="item p-3">
								        <div class="row gx-2 justify-content-between align-items-center">
									        <div class="col-auto">
										       <img class="profile-image" src="images/joojun.png.jpg" alt="">
									        </div>
									        <div class="col">
										        <div class="info"> 
											        <div class="desc">JunHyeok sent you a new message.</div>
											        <div class="meta"> 7 days ago</div>
										        </div>
									        </div> 
								        </div>
								        <a class="link-mask" href="/notifications"></a>
							       </div>-->
						        </div><!--//dropdown-menu-content-->
							
						        <div class="dropdown-menu-footer p-2 text-center">
							        <a href="/notifications">View all</a>
						        </div>
															
							</div><!--//dropdown-menu-->					        
				        </div><!--//app-utility-item-->			            
			            <div class="app-utility-item app-user-dropdown dropdown">
				            <a class="dropdown-toggle" id="user-dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false"><img src="images/minseo.png" alt="user profile"></a>
				            <ul class="dropdown-menu" aria-labelledby="user-dropdown-toggle">
								<li><a class="dropdown-item" href="/notifications">회원 관리</a></li>
								<li><a class="dropdown-item" href="/account">고객 게시판 관리</a></li>
								<li><a class="dropdown-item" href="/product">상품 관리</a></li>	
								<li><hr class="dropdown-divider"></li>
								<li><a class="dropdown-item" href="/auth/logout">로그아웃</a></li>
							</ul>
			            </div><!--//app-user-dropdown--> 
		            </div><!--//app-utilities-->
		        </div><!--//row-->
	            </div><!--//app-header-content-->
	        </div><!--//container-fluid-->
        </div><!--//app-header-inner-->
        <div id="app-sidepanel" class="app-sidepanel sidepanel-hidden"> 
	        <div id="sidepanel-drop" class="sidepanel-drop"></div>
	        <div class="sidepanel-inner d-flex flex-column">
		        <a href="#" id="sidepanel-close" class="sidepanel-close d-xl-none">&times;</a>
		        <div class="app-branding">
		            <a class="app-logo" href="/"><img class="logo-icon me-2" src="images/logo.png" alt="logo"><span class="logo-text">GPUHunt</span></a>
	
		        </div><!--//app-branding-->  
			    <nav id="app-nav-main" class="app-nav app-nav-main flex-grow-1">
				    <ul class="app-menu list-unstyled accordion" id="menu-accordion">
					    <li class="nav-item">
					        <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
					        <a class="nav-link" href="/admin">
						        <span class="nav-icon">
						        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-house-door" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
		  <path fill-rule="evenodd" d="M7.646 1.146a.5.5 0 0 1 .708 0l6 6a.5.5 0 0 1 .146.354v7a.5.5 0 0 1-.5.5H9.5a.5.5 0 0 1-.5-.5v-4H7v4a.5.5 0 0 1-.5.5H2a.5.5 0 0 1-.5-.5v-7a.5.5 0 0 1 .146-.354l6-6zM2.5 7.707V14H6v-4a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4h3.5V7.707L8 2.207l-5.5 5.5z"/>
		  <path fill-rule="evenodd" d="M13 2.5V6l-2-2V2.5a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5z"/>
		</svg>
						         </span>
		                         <span class="nav-link-text">Overview</span>
					        </a><!--//nav-link-->
					    </li><!--//nav-item-->
					    <li class="nav-item has-submenu">
					        <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
					        <a class="nav-link submenu-toggle active" href="#" data-bs-toggle="collapse" data-bs-target="#submenu-1" aria-expanded="true" aria-controls="submenu-1">
						        <span class="nav-icon">
						        <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
						        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-files" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
	  <path fill-rule="evenodd" d="M4 2h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2zm0 1a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h7a1 1 0 0 0 1-1V4a1 1 0 0 0-1-1H4z"/>
	  <path d="M6 0h7a2 2 0 0 1 2 2v10a2 2 0 0 1-2 2v-1a1 1 0 0 0 1-1V2a1 1 0 0 0-1-1H6a1 1 0 0 0-1 1H4a2 2 0 0 1 2-2z"/>
	</svg>
						         </span>
		                         <span class="nav-link-text">Management</span>
		                         <span class="submenu-arrow">
		                             <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-chevron-down" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
	  <path fill-rule="evenodd" d="M1.646 4.646a.5.5 0 0 1 .708 0L8 10.293l5.646-5.647a.5.5 0 0 1 .708.708l-6 6a.5.5 0 0 1-.708 0l-6-6a.5.5 0 0 1 0-.708z"/>
	</svg>
	                             </span><!--//submenu-arrow-->
					        </a><!--//nav-link-->
					        <div id="submenu-1" class="collapse submenu submenu-1 show" data-bs-parent="#menu-accordion">
						        <ul class="submenu-list list-unstyled">
							        <li class="submenu-item"><a class="submenu-link" href="/notifications">회원 관리</a></li>
							        <li class="submenu-item"><a class="submenu-link active" href="/account">고객 게시판 관리</a></li>
									<li class="submenu-item"><a class="submenu-link" href="/product">상품 관리</a></li>
							        
						        </ul>
					        </div>
					    </li><!--//nav-item-->
					    
					   
					    <li class="nav-item">
					        <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
					        <a class="nav-link" href="/charts">
						        <span class="nav-icon">
						        <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-bar-chart-line" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
	  <path fill-rule="evenodd" d="M11 2a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v12h.5a.5.5 0 0 1 0 1H.5a.5.5 0 0 1 0-1H1v-3a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v3h1V7a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v7h1V2zm1 12h2V2h-2v12zm-3 0V7H7v7h2zm-5 0v-3H2v3h2z"/>
	</svg>
						         </span>
		                         <span class="nav-link-text">Charts</span>
					        </a><!--//nav-link-->
					    </li><!--//nav-item-->
					    
				    </ul><!--//app-menu-->
			    </nav><!--//app-nav-->
			    <div class="app-sidepanel-footer">
				    <nav class="app-nav app-nav-footer">
					    <ul class="app-menu footer-menu list-unstyled">
						    
						    <li class="nav-item">
						        <!--//Bootstrap Icons: https://icons.getbootstrap.com/ -->
						        <a class="nav-link" href="https://themes.3rdwavemedia.com/bootstrap-templates/admin-dashboard/portal-free-bootstrap-admin-dashboard-template-for-developers/">
							        <span class="nav-icon">
							            <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-file-person" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
	  <path fill-rule="evenodd" d="M12 1H4a1 1 0 0 0-1 1v10.755S4 11 8 11s5 1.755 5 1.755V2a1 1 0 0 0-1-1zM4 0a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h8a2 2 0 0 0 2-2V2a2 2 0 0 0-2-2H4z"/>
	  <path fill-rule="evenodd" d="M8 10a3 3 0 1 0 0-6 3 3 0 0 0 0 6z"/>
	</svg>
							        </span>
			                        <span class="nav-link-text">출처</span>
						        </a><!--//nav-link-->
						    </li><!--//nav-item-->
					    </ul><!--//footer-menu-->
				    </nav>
			    </div><!--//app-sidepanel-footer-->
	        </div><!--//sidepanel-inner-->
	    </div><!--//app-sidepanel-->
    </header><!--//app-header-->

    <div class="app-wrapper">
	    
	    <div class="app-content pt-3 p-md-3 p-lg-4">
		    <div class="container-xl">
			    <div class="position-relative mb-3">
				    <div class="row g-3 justify-content-between">
					    <div class="col-auto">
					        <h1 class="app-page-title mb-0">고객 게시판 관리</h1>
					    </div>
				    </div>
			    </div>
        
                <!-- 고객 게시판 관리 테이블 시작 -->
                <div class="app-card app-card-notification shadow-sm mb-4">
                    <div class="app-card-header px-4 py-3">
                        <div class="row g-3 align-items-center">
                            <div class="col">
                                <h4 class="app-card-title">고객 게시판 목록</h4>
                            </div>

                        </div>
                    </div>
                    <div class="app-card-body p-4">
                        <table class="table table-bordered">
                            <thead>
                                <tr>
                                    <th class="name" name="name">작성자</th>
                                    <th class="email" name="email">이메일</th>
                                    <th class="subject" name="subject">주제</th>
                                    <th class="message" name="message">내용</th>
                                    <th class="actions">삭제</th>
                                </tr>
                            </thead>
                            <tbody id="boardTableBody">
                            </tbody>
                        </table>
                    </div>
                </div>
                <!-- 고객 게시판 관리 테이블 끝 -->
            </div>
        </div>
        <footer class="app-footer">
            <div class="container text-center py-3"></div>
        </footer>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
    
    <script>
        // 서버에서 게시글 데이터를 가져오는 함수
        function GetMsg() {
            $.ajax({
                url: '/msg',
                method: 'GET',
                dataType: 'json',
                success: function(data) {
                    addTable(data); // 받아온 데이터를 테이블에 추가하는 함수 호출
                }
            });
        }
        function deleteMsg(name,row) {
            row.remove();
            $.ajax({
                url: '/delete', 
                method: 'GET',
                data: { name: name },
                success: function() {
                    GetMsg();
                }
            });
        }
        // 게시글을 추가하는 함수
        function addTable(datas) {
            const tbody = document.getElementById('boardTableBody');

            datas.forEach(data => {
                // 새로운 행(tr)을 생성
                const row = document.createElement('tr');
                // 각 데이터에 맞는 열(td)을 생성 및 설정
                row.innerHTML = `
                    <th class="name">${data.name}</th>
                    <th class="email">${data.email}</th>
                    <th class="subject">${data.subject}</th>
                    <th class="message">${data.message}</th>
                    <th class="actions">
                        <button class="btn btn-sm btn-danger" onclick="deleteMsg('${data.name}', this.parentNode.parentNode)">삭제</button>
                    </th>
                `;
                // 생성된 행을 tbody에 추가
                tbody.appendChild(row);          
            });
        }
        // 초기화 함수: 페이지 로드 시 호출하여 게시글을 테이블에 추가
        $(document).ready(function() {
            GetMsg(); // 페이지 로드 시 서버에서 게시글 데이터 가져오기
        });
    </script>
    

    <!-- Javascript -->
    <script src="plugins/popper.min.js"></script>
    <script src="plugins/bootstrap/js/bootstrap.min.js"></script>
    <script src="js/app.js"></script>
    <script>
        // 게시판 추가 폼 제출 시 이벤트 처리
        document.getElementById('addBoardForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // 폼 데이터 가져오기
            const title = document.getElementById('boardTitle').value;
            const author = document.getElementById('boardAuthor').value;
            const date = document.getElementById('boardDate').value;
            
            // 게시판 목록 테이블에 추가
            const tableBody = document.getElementById('boardTableBody');
            const newRow = document.createElement('tr');
            newRow.innerHTML = `
                <th scope="row">${tableBody.rows.length + 1}</th>
                <td class="content">${title}</td>
                <td class="author">${author}</td>
                <td class="date">${date}</td>
                <td class="actions">
                    <button class="btn btn-sm btn-warning">수정</button>
                    <button class="btn btn-sm btn-danger">삭제</button>
                </td>
                <td class="answer">
                    <button class="btn btn-sm btn-primary" data-bs-toggle="modal" data-bs-target="#addAnswerModal" data-board-id="${tableBody.rows.length + 1}">답변 추가</button>
                    <ul id="answers-${tableBody.rows.length + 1}"></ul>
                </td>
            `;
            tableBody.appendChild(newRow);
            
            // 모달 닫기
            const addBoardModal = new bootstrap.Modal(document.getElementById('addBoardModal'));
            addBoardModal.hide();
            
            // 폼 초기화
            e.target.reset();
        });

        // 답변 추가 모달 열기 이벤트 처리
        document.getElementById('addAnswerModal').addEventListener('show.bs.modal', function (event) {
            const button = event.relatedTarget;
            const boardId = button.getAttribute('data-board-id');
            document.getElementById('currentBoardId').value = boardId;
        });

        // 답변 추가 폼 제출 시 이벤트 처리
        document.getElementById('addAnswerForm').addEventListener('submit', function(e) {
            e.preventDefault();

            // 폼 데이터 가져오기
            const content = document.getElementById('answerContent').value;
            const boardId = document.getElementById('currentBoardId').value;
            
            // 답변 목록에 추가
            const answerList = document.getElementById(`answers-${boardId}`);
            const newAnswer = document.createElement('li');
            newAnswer.textContent = content;
            answerList.appendChild(newAnswer);

            // 모달 닫기
            const addAnswerModal = new bootstrap.Modal(document.getElementById('addAnswerModal'));
            addAnswerModal.hide();

            // 폼 초기화
            e.target.reset();
        });

        // 필터 옵션 변경 시 이벤트 처리
        document.getElementById('filterOptions').addEventListener('change', function() {
            const selectedOption = this.value;
            const table = document.querySelector('table');
            const rows = table.querySelectorAll('tbody tr');
            const headers = table.querySelectorAll('thead th');

            // 모든 열 숨기기
            headers.forEach((header, index) => {
                if (index > 0) header.style.display = 'none';
            });
            rows.forEach(row => {
                row.querySelectorAll('td').forEach((cell, index) => {
                    cell.style.display = 'none';
                });
            });

            // 선택된 열 표시
            let columnIndex;
            switch (selectedOption) {
                case 'content':
                    columnIndex = 1;
                    break;
                case 'author':
                    columnIndex = 2;
                    break;
                case 'date':
                    columnIndex = 3;
                    break;
                case 'answer':
                    columnIndex = 5;
                    break;
                default:
                    columnIndex = 'all';
                    break;
            }

            if (columnIndex === 'all') {
                headers.forEach((header, index) => {
                    if (index > 0) header.style.display = '';
                });
                rows.forEach(row => {
                    row.querySelectorAll('td').forEach((cell, index) => {
                        cell.style.display = '';
                    });
                });
            } else {
                headers[columnIndex].style.display = '';
                rows.forEach(row => {
                    row.querySelectorAll('td')[columnIndex - 1].style.display = '';
                });
            }
        });
    </script>
</body>
</html>
